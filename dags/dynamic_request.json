{
    "final_project": {
        "dag": {
            "dag_name": "final_project",
            "schedule_interval": 14
        },
        "args" : {
            "owner": "Faqih",
            "email": ["abdullah.mubarok@tokopedia.com", "rubila.adawiyah@tokopedia.com", "lulu.sundayana@tokopedia.com"],
            "email_on_failure": true,
            "provide_context": true
            
        },
        "start_date": "2019-02-02",
        "connection": {
            "bq_conn_id": "rubi_bq",
            "bq_project_destination": "primeval-beaker-175012",
            "bq_dataset_destination": "order_recharge",
            "bq_table_destination": "order_recharge_2",
            "bucket_destination": "exampledataset",
            "folder_in_bucket": "order_recharge/"
        },
        "model": {
            "is_using_ml": false,
            "target_forecast": "transaction",
            "category": "category_id"
        },
        "query": "SELECT nor.category_id, DATE( TIMESTAMP_ADD(nor.create_time, INTERVAL 7 hour) ) ds, COUNT(1) y FROM `ws_order_recharge.order_recharge` nor WHERE nor.create_time BETWEEN TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND nor.order_status IN (700, 701, 702) AND category_id IN (1,2) GROUP BY 1, 2 ORDER BY 1, 2"
    },
    "pipeline1": {
        "dag": {
            "dag_name": "pipeline1",
            "schedule_interval": 14
        },
        "args" : {
            "owner": "Faqih",
            "email": ["abdullah.mubarok@tokopedia.com", "rubila.adawiyah@tokopedia.com", "lulu.sundayana@tokopedia.com"],
            "email_on_failure": true,
            "provide_context": true
            
        },
        "start_date": "2019-02-02",
        "connection": {
            "bq_conn_id": "rubi_bq",
            "bq_project_destination": "primeval-beaker-175012",
            "bq_dataset_destination": "order_recharge",
            "bq_table_destination": "order_recharge_2",
            "bucket_destination": "exampledataset",
            "folder_in_bucket": "order_recharge/"
        },
        "model": {
            "is_using_ml": false,
            "target_forecast": "transaction",
            "category": "category_id"
        },
        "query": "SELECT nor.category_id, DATE( TIMESTAMP_ADD(nor.create_time, INTERVAL 7 hour) ) ds, COUNT(1) y FROM `ws_order_recharge.order_recharge` nor WHERE nor.create_time BETWEEN TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND nor.order_status IN (700, 701, 702) AND category_id IN (1,2) GROUP BY 1, 2 ORDER BY 1, 2"
    },
    "pipeline2": {
        "dag": {
            "dag_name": "pipeline2",
            "schedule_interval": 14
        },
        "args" : {
            "owner": "Faqih",
            "email": ["abdullah.mubarok@tokopedia.com", "rubila.adawiyah@tokopedia.com", "lulu.sundayana@tokopedia.com"],
            "email_on_failure": true,
            "provide_context": true
            
        },
        "start_date": "2019-02-02",
        "connection": {
            "bq_conn_id": "rubi_bq",
            "bq_project_destination": "primeval-beaker-175012",
            "bq_dataset_destination": "order_recharge",
            "bq_table_destination": "order_recharge_2",
            "bucket_destination": "exampledataset",
            "folder_in_bucket": "order_recharge/"
        },
        "model": {
            "is_using_ml": false,
            "target_forecast": "transaction",
            "category": "category_id"
        },
        "query": "SELECT nor.category_id, DATE( TIMESTAMP_ADD(nor.create_time, INTERVAL 7 hour) ) ds, COUNT(1) y FROM `ws_order_recharge.order_recharge` nor WHERE nor.create_time BETWEEN TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND TIMESTAMP_ADD( timestamp '{}', INTERVAL -7 hour ) AND nor.order_status IN (700, 701, 702) AND category_id IN (1,2) GROUP BY 1, 2 ORDER BY 1, 2"
    }
}